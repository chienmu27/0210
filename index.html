<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>å¸‚æ•™è‚²æœƒå ±åèˆ‡æŸ¥è©¢ç³»çµ±</title>

  <style>
    :root{
      --court-green:#1f8a4c;
      --court-green-2:#2bb673;
      --court-line:rgba(255,255,255,.85);
      --sky:#eaf7ff;
      --ink:#14322a;
      --card:#ffffffcc;
      --shadow: 0 10px 30px rgba(0,0,0,.12);
      --blue:#1e88ff;
      --blue-2:#0f62d6;
      --accent:#ffcc4d;
    }

    *{ box-sizing:border-box; }

    body{
      font-family:"Microsoft JhengHei", system-ui, -apple-system, "Segoe UI", Arial, sans-serif;
      margin:0;
      padding:22px 14px 40px;
      color:var(--ink);
      text-align:center;

      /* å¯æ„›ç¾½çƒå ´èƒŒæ™¯ */
      background:
        radial-gradient(circle at 18% 12%, rgba(255,255,255,.85) 0 10px, transparent 11px),
        radial-gradient(circle at 82% 18%, rgba(255,255,255,.75) 0 12px, transparent 13px),
        radial-gradient(circle at 12% 78%, rgba(255,255,255,.65) 0 9px, transparent 10px),
        radial-gradient(circle at 88% 82%, rgba(255,255,255,.7) 0 10px, transparent 11px),
        linear-gradient(180deg, var(--sky) 0%, #dff3ff 20%, #cfefff 35%, #bfe7ff 45%, transparent 55%),
        linear-gradient(180deg, rgba(0,0,0,0) 0%, rgba(0,0,0,0) 45%, rgba(0,0,0,.06) 100%),
        linear-gradient(135deg, var(--court-green) 0%, var(--court-green-2) 100%);
      min-height:100vh;

      /* ç‰ˆé¢æ°´å¹³ç½®ä¸­ã€å‚ç›´é ä¸Š */
      display:flex;
      justify-content:center;
      align-items:flex-start;
    }

    /* å¤–æ¡†å®¹å™¨ */
    .wrap{
      width:min(980px, 100%);
      margin:0 auto;
    }

    /* æ¨™é¡Œå€ */
    .title{
      display:flex;
      align-items:center;
      justify-content:center;
      gap:12px;
      margin:6px 0 14px;
    }

    .title-badge{
      width:44px;height:44px;
      border-radius:14px;
      background: rgba(255,255,255,.65);
      box-shadow: 0 8px 20px rgba(0,0,0,.12);
      position:relative;
      overflow:hidden;
    }

    /* å°çƒæ‹å‹•ç•«ï¼ˆtab çƒæ‹å‹•ç•«ï¼‰ */
    .racket{
      position:absolute;
      left:50%; top:50%;
      width:26px; height:26px;
      transform: translate(-50%,-50%) rotate(-10deg);
      animation: racketSwing 2.2s ease-in-out infinite;
    }

    @keyframes racketSwing{
      0%   { transform: translate(-50%,-50%) rotate(-18deg); }
      50%  { transform: translate(-50%,-50%) rotate(14deg); }
      100% { transform: translate(-50%,-50%) rotate(-18deg); }
    }

    h1{
      margin:0;
      font-size: clamp(22px, 3.2vw, 30px);
      letter-spacing:.5px;
      text-shadow: 0 2px 0 rgba(255,255,255,.45);
    }

    /* å°è¦½æŒ‰éˆ•å€ */
    .nav-buttons{
      display:flex;
      justify-content:center;
      flex-wrap:wrap;
      gap:10px;
      margin:10px 0 18px;
    }

    .btn{
      position:relative;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      gap:8px;

      padding:11px 18px;
      font-size:16px;
      cursor:pointer;
      border:none;
      color:white;
      border-radius:999px;
      background: linear-gradient(180deg, var(--blue) 0%, var(--blue-2) 100%);
      box-shadow: 0 10px 22px rgba(30,136,255,.28);
      transition: transform .18s ease, box-shadow .18s ease, filter .18s ease;
      user-select:none;
      overflow:hidden;
      min-width: 150px;
    }

    .btn:active{
      transform: translateY(1px) scale(.99);
    }

    .btn:hover{
      transform: translateY(-2px);
      box-shadow: 0 16px 28px rgba(30,136,255,.32);
      filter: brightness(1.03);
    }

    /* ç¾½æ¯›çƒ iconï¼ˆæŒ‰éˆ•ï¼‰ */
    .btn .icon{
      width:18px;height:18px;
      flex:0 0 18px;
      filter: drop-shadow(0 2px 2px rgba(0,0,0,.15));
    }

    /* hover ç¾½çƒç§»å‹•æ•ˆæœ */
    .btn .shuttle{
      position:absolute;
      right:-24px;
      top:50%;
      width:18px;height:18px;
      transform: translateY(-50%) rotate(20deg);
      opacity:.0;
      transition: right .55s ease, opacity .25s ease, transform .55s ease;
      pointer-events:none;
      filter: drop-shadow(0 3px 4px rgba(0,0,0,.18));
    }

    .btn:hover .shuttle{
      right: 10px;
      opacity: .95;
      transform: translateY(-50%) rotate(-12deg);
    }

    /* å…§å®¹å¡ç‰‡ï¼ˆsectionï¼‰ */
    .section{
      display:none;
      background: var(--card);
      padding:18px;
      border-radius:18px;
      box-shadow: var(--shadow);
      max-width: 900px;
      margin: 0 auto;
      border: 1px solid rgba(255,255,255,.55);
      backdrop-filter: blur(8px);
    }

    .active{ display:block; }

    /* å¯æ„›çƒå ´ç·šæ¢è£é£¾ */
    .section::before{
      content:"";
      display:block;
      height:10px;
      border-radius:999px;
      margin-bottom:14px;
      background:
        linear-gradient(90deg,
          rgba(255,255,255,.0) 0%,
          rgba(255,255,255,.75) 15%,
          rgba(255,255,255,.75) 85%,
          rgba(255,255,255,.0) 100%);
      opacity:.9;
    }

    iframe{
      width:100%;
      height:2550px;
      border:none;
      border-radius:14px;
      background:white;
      box-shadow: 0 10px 24px rgba(0,0,0,.08);
    }

    .search-box{
      margin-bottom: 16px;
      padding: 12px 10px 4px;
    }

    .search-box h3{
      margin: 4px 0 12px;
      font-size: 16px;
      font-weight: 800;
    }

    input[type="text"]{
      padding: 10px 12px;
      width: 220px;
      border: 1px solid rgba(20,50,42,.25);
      border-radius: 12px;
      outline: none;
      background: rgba(255,255,255,.85);
      box-shadow: 0 6px 16px rgba(0,0,0,.06);
      transition: border-color .2s ease, transform .2s ease, box-shadow .2s ease;
    }

    input[type="text"]:focus{
      border-color: rgba(30,136,255,.65);
      box-shadow: 0 10px 20px rgba(30,136,255,.18);
      transform: translateY(-1px);
    }

    /* æŸ¥è©¢çµæœå¡ç‰‡ */
    .result-card{
      text-align:left;
      border-left: 6px solid rgba(255,255,255,.9);
      padding: 14px 14px;
      margin: 12px 0;
      background: rgba(255,255,255,.86);
      border-bottom: 1px solid rgba(0,0,0,.06);
      border-radius: 16px;
      box-shadow: 0 10px 18px rgba(0,0,0,.08);
      position:relative;
      overflow:hidden;
    }

    .result-card::after{
      content:"";
      position:absolute;
      right:-30px;
      top:-30px;
      width:110px;height:110px;
      background: radial-gradient(circle at 30% 30%, rgba(255,204,77,.55), transparent 55%);
      transform: rotate(10deg);
      opacity:.8;
      pointer-events:none;
    }

    .result-card p{
      margin: 6px 0;
      line-height: 1.6;
      font-size: 15px;
    }

    .result-card strong{
      color:#0f3a2f;
    }

    .loading{
      color: rgba(20,50,42,.75);
      font-style: italic;
      padding: 10px 0;
    }

    /* å°è¢å¹•å„ªåŒ– */
    @media (max-width: 520px){
      .btn{ min-width: 140px; }
      input[type="text"]{ width: 100%; max-width: 320px; }
      iframe{ height: 2600px; }
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="title">
      <div class="title-badge" aria-hidden="true">
        <!-- çƒæ‹ SVGï¼ˆæœƒå‹•ç•«ï¼‰ -->
        <svg class="racket" viewBox="0 0 64 64">
          <defs>
            <linearGradient id="g1" x1="0" y1="0" x2="0" y2="1">
              <stop offset="0" stop-color="#1e88ff"/>
              <stop offset="1" stop-color="#0f62d6"/>
            </linearGradient>
          </defs>
          <!-- æ‹é¢ -->
          <ellipse cx="28" cy="24" rx="14" ry="18" fill="none" stroke="url(#g1)" stroke-width="4"/>
          <ellipse cx="28" cy="24" rx="10" ry="14" fill="none" stroke="rgba(30,136,255,.35)" stroke-width="2"/>
          <!-- æ‰‹æŠŠ -->
          <path d="M36 38 L52 54" stroke="#0f3a2f" stroke-width="6" stroke-linecap="round"/>
          <path d="M38 40 L50 52" stroke="rgba(255,255,255,.35)" stroke-width="2" stroke-linecap="round"/>
        </svg>
      </div>
      <h1>å¸‚æ•™è‚²æœƒå ±åç³»çµ±</h1>
    </div>

    <div class="nav-buttons">
      <button class="btn" onclick="showSection('form-section')">
        <!-- ç¾½æ¯›çƒ icon -->
        <svg class="icon" viewBox="0 0 64 64" aria-hidden="true">
          <path d="M16 46 C18 30, 30 16, 46 12" fill="none" stroke="white" stroke-width="4" stroke-linecap="round"/>
          <path d="M18 50 C24 38, 36 26, 52 20" fill="none" stroke="white" stroke-width="4" stroke-linecap="round" opacity=".9"/>
          <path d="M22 54 C30 44, 44 30, 58 26" fill="none" stroke="white" stroke-width="4" stroke-linecap="round" opacity=".8"/>
          <path d="M10 54 L30 34" stroke="white" stroke-width="5" stroke-linecap="round"/>
          <circle cx="10" cy="54" r="4" fill="white"/>
        </svg>
        å ±åè¡¨å–®

        <!-- hover ç§»å‹•ç¾½çƒ -->
        <svg class="shuttle" viewBox="0 0 64 64" aria-hidden="true">
          <path d="M22 10 L42 10 L38 26 L26 26 Z" fill="white" opacity=".95"/>
          <path d="M26 26 L38 26 L46 44 L18 44 Z" fill="white" opacity=".95"/>
          <path d="M18 44 L46 44 L40 56 L24 56 Z" fill="white" opacity=".95"/>
          <path d="M20 56 L44 56" stroke="rgba(0,0,0,.15)" stroke-width="3" stroke-linecap="round"/>
        </svg>
      </button>

      <button class="btn" onclick="showSection('search-section')">
        <!-- ç¾½æ¯›çƒ icon -->
        <svg class="icon" viewBox="0 0 64 64" aria-hidden="true">
          <path d="M16 46 C18 30, 30 16, 46 12" fill="none" stroke="white" stroke-width="4" stroke-linecap="round"/>
          <path d="M18 50 C24 38, 36 26, 52 20" fill="none" stroke="white" stroke-width="4" stroke-linecap="round" opacity=".9"/>
          <path d="M22 54 C30 44, 44 30, 58 26" fill="none" stroke="white" stroke-width="4" stroke-linecap="round" opacity=".8"/>
          <path d="M10 54 L30 34" stroke="white" stroke-width="5" stroke-linecap="round"/>
          <circle cx="10" cy="54" r="4" fill="white"/>
        </svg>
        å ±åçµæœæŸ¥è©¢

        <!-- hover ç§»å‹•ç¾½çƒ -->
        <svg class="shuttle" viewBox="0 0 64 64" aria-hidden="true">
          <path d="M22 10 L42 10 L38 26 L26 26 Z" fill="white" opacity=".95"/>
          <path d="M26 26 L38 26 L46 44 L18 44 Z" fill="white" opacity=".95"/>
          <path d="M18 44 L46 44 L40 56 L24 56 Z" fill="white" opacity=".95"/>
          <path d="M20 56 L44 56" stroke="rgba(0,0,0,.15)" stroke-width="3" stroke-linecap="round"/>
        </svg>
      </button>
    </div>

    <!-- å ±åè¡¨å–®å€å¡Š -->
    <div id="form-section" class="section active">
      <iframe src="https://docs.google.com/forms/d/e/1FAIpQLScazVR5wTsHqvLmj3yRu12UppwnQlRBbSDZ1hnhHbTNTKkvoQ/viewform">è¼‰å…¥ä¸­â€¦</iframe>
    </div>

    <!-- å ±åæŸ¥è©¢å€å¡Š -->
    <div id="search-section" class="section">
      <div class="search-box">
        <h3>è«‹è¼¸å…¥èº«åˆ†è­‰å­—è™Ÿå¾Œ5ç¢¼é€²è¡Œé©—è­‰ ğŸ¸</h3>
        <input type="text" id="idInput" placeholder="ä¾‹å¦‚: 12345" maxlength="5" />
        <button class="btn" onclick="searchData()">
          <svg class="icon" viewBox="0 0 64 64" aria-hidden="true">
            <path d="M16 46 C18 30, 30 16, 46 12" fill="none" stroke="white" stroke-width="4" stroke-linecap="round"/>
            <path d="M18 50 C24 38, 36 26, 52 20" fill="none" stroke="white" stroke-width="4" stroke-linecap="round" opacity=".9"/>
            <path d="M22 54 C30 44, 44 30, 58 26" fill="none" stroke="white" stroke-width="4" stroke-linecap="round" opacity=".8"/>
            <path d="M10 54 L30 34" stroke="white" stroke-width="5" stroke-linecap="round"/>
            <circle cx="10" cy="54" r="4" fill="white"/>
          </svg>
          æŸ¥è©¢
          <svg class="shuttle" viewBox="0 0 64 64" aria-hidden="true">
            <path d="M22 10 L42 10 L38 26 L26 26 Z" fill="white" opacity=".95"/>
            <path d="M26 26 L38 26 L46 44 L18 44 Z" fill="white" opacity=".95"/>
            <path d="M18 44 L46 44 L40 56 L24 56 Z" fill="white" opacity=".95"/>
            <path d="M20 56 L44 56" stroke="rgba(0,0,0,.15)" stroke-width="3" stroke-linecap="round"/>
          </svg>
        </button>
      </div>

      <div id="result-area"></div>
    </div>
  </div>

  <script>
    // *** é‡è¦ï¼šè«‹å°‡æ­¤è™•æ›¿æ›ç‚ºä½ éƒ¨ç½²çš„ Google Apps Script URL ***
    var GAS_URL = "https://script.google.com/macros/s/AKfycby0CXFWAvxrTp-OKfZbWX2GFxYV6YnTZfwRIvI4xp8GFidz2lzG4fwuUKMICA6Dc-5p/exec";

    function showSection(id) {
      document.querySelectorAll(".section").forEach((s) => s.classList.remove("active"));
      document.getElementById(id).classList.add("active");
    }

    function maskName(name) {
      if (!name) return "";
      if (name.length <= 2) return name.substring(0, 1) + "ï¼Š";
      return name.substring(0, 1) + "ï¼Š" + name.substring(name.length - 1);
    }

    function maskID(id) {
      if (!id || id.length < 10) return id;
      return id.substring(0, 4) + "****" + id.substring(id.length - 2);
    }

    function formatDate(dateStr) {
      if (!dateStr) return "";
      let d = new Date(dateStr);
      if (isNaN(d.getTime())) return dateStr;
      return d.getFullYear() + "/" + (d.getMonth() + 1) + "/" + d.getDate();
    }

    async function searchData() {
      const idValue = document.getElementById("idInput").value.trim();
      const resultArea = document.getElementById("result-area");

      if (idValue.length !== 5) {
        alert("è«‹è¼¸å…¥æ­£ç¢ºçš„èº«åˆ†è­‰å¾Œ5ç¢¼");
        return;
      }

      resultArea.innerHTML = '<p class="loading">æŸ¥è©¢ä¸­ï¼Œç¾½çƒé£›è¡Œä¸­... ğŸ¸</p>';

      try {
        const response = await fetch(`${GAS_URL}?id=${idValue}`);
        const data = await response.json();

        if (data.length === 0) {
          resultArea.innerHTML = "<p style='color:#b00020;font-weight:700;'>æŸ¥ç„¡è³‡æ–™ï¼Œè«‹ç¢ºèªè¼¸å…¥æ˜¯å¦æ­£ç¢ºæˆ–å°šæœªå®Œæˆå ±åã€‚</p>";
          return;
        }

        let html = "";
        data.forEach((item) => {
          html += `
            <div class="result-card">
              <p><strong>åºè™Ÿï¼š</strong>${item.serial}</p>
              <p><strong>çµ„åˆ¥ï¼š</strong>${item.group}</p>
              <p><strong>é¸æ‰‹å§“åï¼š</strong>${maskName(item.name)}</p>
              <p><strong>æœå‹™å–®ä½ï¼š</strong>${item.unit}</p>
              <p><strong>èº«åˆ†è­‰å­—è™Ÿï¼š</strong>${maskID(item.id)}</p>
              <p><strong>å‡ºç”Ÿå¹´æœˆæ—¥ï¼š</strong>${formatDate(item.birthday)}</p>
              <p><strong>æˆ¶ç±åœ°å€ï¼š</strong>${item.address}</p>
            </div>
          `;
        });

        resultArea.innerHTML = html;
      } catch (error) {
        console.error(error);
        resultArea.innerHTML =
          "<p style='color:#b00020;font-weight:700;'>æŸ¥è©¢å‡ºéŒ¯ï¼Œè«‹ç¨å¾Œå†è©¦æˆ–æª¢æŸ¥ GAS éƒ¨ç½²è¨­å®šã€‚</p>";
      }
    }
  </script>
</body>
</html>
