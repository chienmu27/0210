<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>å¸‚æ•™è‚²æœƒå ±åèˆ‡æŸ¥è©¢ç³»çµ±</title>

  <style>
    :root {
      --court-green: #2e7d32;
      --court-green-light: #4caf50;
      --shuttle-white: #ffffff;
      --sky-blue: #e3f2fd;
      --accent-yellow: #fff176;
      --btn-blue: #1e88ff;
      --shadow: 0 12px 30px rgba(0,0,0,0.1);
    }

    * { box-sizing: border-box; }

    body {
      font-family: "Microsoft JhengHei", system-ui, sans-serif;
      margin: 0;
      padding: 30px 15px;
      color: #1b5e20;
      background: 
        radial-gradient(circle at 20% 20%, rgba(255,255,255,0.4) 0%, transparent 20%),
        linear-gradient(135deg, var(--sky-blue) 0%, #c8e6c9 100%);
      background-attachment: fixed;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: flex-start;
    }

    .wrap {
      width: min(900px, 100%);
      animation: fadeIn 0.8s ease-out;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* æ¨™é¡Œèˆ‡çƒæ‹åµŒå…¥ */
    .title-container {
      text-align: center;
      margin-bottom: 25px;
    }

    h1 {
      margin: 0;
      font-size: clamp(18px, 4.5vw, 28px);
      background: var(--court-green);
      color: white;
      padding: 10px 30px;
      border-radius: 50px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
      display: inline-flex;
      align-items: center;
      gap: 12px;
    }

    .racket-inline {
      width: 36px;
      height: 36px;
      flex-shrink: 0;
      animation: racketSwing 2s ease-in-out infinite;
    }

    @keyframes racketSwing {
      0%, 100% { transform: rotate(-15deg); }
      50% { transform: rotate(20deg); }
    }

    /* å°è¦½æŒ‰éˆ•å€ */
    .nav-buttons {
      display: flex;
      justify-content: center;
      gap: 12px;
      margin-bottom: 25px;
      flex-wrap: wrap;
    }

    .btn {
      position: relative;
      padding: 12px 25px;
      font-size: 16px;
      font-weight: bold;
      cursor: pointer;
      border: none;
      color: white;
      border-radius: 50px;
      background: linear-gradient(180deg, var(--btn-blue) 0%, #1565c0 100%);
      box-shadow: 0 6px 15px rgba(30,136,255,0.3);
      transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      min-width: 160px;
      overflow: hidden;
    }

    .btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 10px 20px rgba(30,136,255,0.4);
    }

    /* Hover ç¾½çƒé£›ç¿”æ•ˆæœ */
    .btn::after {
      content: 'ğŸ¸';
      position: absolute;
      right: -30px;
      top: 50%;
      transform: translateY(-50%) scale(0.5);
      opacity: 0;
      transition: all 0.4s ease;
    }

    .btn:hover::after {
      right: 12px;
      opacity: 1;
      transform: translateY(-50%) scale(1) rotate(-15deg);
    }

    /* å…§å®¹å€å¡Š */
    .section {
      display: none;
      background: rgba(255, 255, 255, 0.9);
      padding: 25px;
      border-radius: 20px;
      box-shadow: var(--shadow);
      border: 2px solid white;
      backdrop-filter: blur(10px);
    }

    .active { 
      display: block; 
      animation: slideDown 0.5s ease-out;
    }

    @keyframes slideDown {
      from { opacity: 0; transform: translateY(-10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* è¡¨å–®é«˜åº¦æ”¹ç‚º 2500px */
    iframe {
      width: 100%;
      height: 2500px;
      border: none;
      border-radius: 12px;
      background: white;
    }

    .search-box {
      padding: 10px 0 20px;
      border-bottom: 2px dashed #c8e6c9;
      margin-bottom: 20px;
    }

    input[type="text"] {
      padding: 12px 20px;
      width: 200px;
      border: 2px solid #ddd;
      border-radius: 12px;
      outline: none;
      transition: all 0.3s;
      font-size: 16px;
      text-align: center;
      margin-right: 10px;
    }

    input[type="text"]:focus {
      border-color: var(--btn-blue);
      box-shadow: 0 0 10px rgba(30,136,255,0.2);
    }

    .result-card {
      text-align: left;
      background: white;
      padding: 20px;
      margin: 15px 0;
      border-radius: 15px;
      border-left: 8px solid var(--court-green-light);
      box-shadow: 0 5px 15px rgba(0,0,0,0.05);
      position: relative;
    }

    .result-card::before {
      content: 'ğŸ¸';
      position: absolute;
      right: 15px;
      top: 15px;
      font-size: 24px;
      opacity: 0.2;
    }

    .result-card p {
      margin: 8px 0;
      border-bottom: 1px solid #f0f0f0;
      padding-bottom: 4px;
      font-size: 16px;
    }

    .result-card strong { color: var(--court-green); margin-right: 5px; }

    .loading { color: var(--court-green); font-weight: bold; padding: 20px; }

    @media (max-width: 600px) {
      input[type="text"] { width: 100%; margin-bottom: 15px; }
      .btn { width: 100%; }
      h1 { padding: 10px 20px; }
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="title-container">
      <h1>
        <svg class="racket-inline" viewBox="0 0 64 64">
          <ellipse cx="28" cy="24" rx="14" ry="18" fill="none" stroke="white" stroke-width="4"/>
          <path d="M36 38 L52 54" stroke="white" stroke-width="6" stroke-linecap="round"/>
          <path d="M20 15 L36 33 M18 28 L38 20" stroke="white" stroke-width="1.5" opacity="0.4"/>
        </svg>
        å¸‚æ•™è‚²æœƒå ±åç³»çµ±
      </h1>
    </div>

    <div class="nav-buttons">
      <button class="btn" onclick="showSection('form-section')">å ±åè¡¨å–®</button>
      <button class="btn" onclick="showSection('search-section')">å ±åçµæœæŸ¥è©¢</button>
    </div>

    <div id="form-section" class="section active">
      <iframe src="https://docs.google.com/forms/d/e/1FAIpQLScazVR5wTsHqvLmj3yRu12UppwnQlRBbSDZ1hnhHbTNTKkvoQ/viewform">è¼‰å…¥ä¸­â€¦</iframe>
    </div>

    <div id="search-section" class="section">
      <div class="search-box">
        <h3>ğŸ¸ è«‹è¼¸å…¥èº«åˆ†è­‰å¾Œ5ç¢¼é©—è­‰</h3>
        <input type="text" id="idInput" placeholder="ä¾‹å¦‚: 12345" maxlength="5" />
        <button class="btn" onclick="searchData()" style="min-width: 120px;">é–‹å§‹æŸ¥è©¢</button>
      </div>
      <div id="result-area"></div>
    </div>
  </div>

  <script>
    var GAS_URL = "https://script.google.com/macros/s/AKfycby0CXFWAvxrTp-OKfZbWX2GFxYV6YnTZfwRIvI4xp8GFidz2lzG4fwuUKMICA6Dc-5p/exec";

    function showSection(id) {
      document.querySelectorAll(".section").forEach((s) => s.classList.remove("active"));
      document.getElementById(id).classList.add("active");
    }

    function maskName(name) {
      if (!name) return "";
      if (name.length <= 2) return name.substring(0, 1) + "ï¼Š";
      return name.substring(0, 1) + "ï¼Š" + name.substring(name.length - 1);
    }

    function maskID(id) {
      if (!id || id.length < 10) return id;
      return id.substring(0, 4) + "****" + id.substring(id.length - 2);
    }

    function formatDate(dateStr) {
      if (!dateStr) return "";
      let d = new Date(dateStr);
      if (isNaN(d.getTime())) return dateStr;
      return d.getFullYear() + "/" + (d.getMonth() + 1) + "/" + d.getDate();
    }

    async function searchData() {
      const idValue = document.getElementById("idInput").value.trim();
      const resultArea = document.getElementById("result-area");

      if (idValue.length !== 5) {
        alert("è«‹è¼¸å…¥æ­£ç¢ºçš„èº«åˆ†è­‰å¾Œ5ç¢¼");
        return;
      }

      resultArea.innerHTML = '<p class="loading">æ­£åœ¨å ´ä¸Šå°‹æ‰¾è³‡æ–™... ğŸ¸</p>';

      try {
        const response = await fetch(`${GAS_URL}?id=${idValue}`);
        const data = await response.json();

        if (data.length === 0) {
          resultArea.innerHTML = "<p style='color:#d32f2f; font-weight:bold; padding:20px;'>æŸ¥ç„¡è³‡æ–™ï¼Œè«‹ç¢ºèªèº«åˆ†è­‰å¾Œ5ç¢¼æˆ–æ˜¯å¦å·²å ±åæˆåŠŸã€‚</p>";
          return;
        }

        let html = "";
        data.forEach((item) => {
          const fields = [
            { label: "åºè™Ÿ", value: item.serial },
            { label: "çµ„åˆ¥", value: item.group },
            { label: "é¸æ‰‹å§“å", value: maskName(item.name) },
            { label: "æœå‹™å–®ä½", value: item.unit },
            { label: "èº«åˆ†è­‰å­—è™Ÿ", value: maskID(item.id) },
            { label: "å‡ºç”Ÿå¹´æœˆæ—¥", value: formatDate(item.birthday) },
            { label: "æˆ¶ç±åœ°å€", value: item.address }
          ];

          html += `<div class="result-card">`;
          fields.forEach(f => {
            if (f.value && String(f.value).trim() !== "") {
              html += `<p><strong>${f.label}ï¼š</strong>${f.value}</p>`;
            }
          });
          html += `</div>`;
        });

        resultArea.innerHTML = html;
      } catch (error) {
        console.error(error);
        resultArea.innerHTML = "<p style='color:#d32f2f; font-weight:bold;'>ç³»çµ±é€£ç·šç•°å¸¸ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚</p>";
      }
    }
  </script>
</body>
</html>
